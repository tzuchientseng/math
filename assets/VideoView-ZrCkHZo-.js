import{j as _,u as f,d as m,r as p,k as g,l as y,c as o,a as s,b as v,e as k,i as w,m as x,h as i,n as h,t as d,p as b,T as V,F as S,q as U,o as a,_ as A}from"./index-CO5BSF79.js";const T="https://sunnytseng.com/api/math-api/fetchUrl/",C=_("url",{state:()=>({videos:[],loading:!1}),getters:{hasVideos:c=>c.videos.length>0},actions:{async fetchUrl(c){const r=f();this.loading=!0;try{const e=await fetch(`${T}?grade=${c}`,{method:"GET",headers:{Authorization:`Bearer ${r.token??""}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error("Fetch Failed");const u=await e.json();this.videos=Array.isArray(u.videos)?u.videos:[]}catch(e){console.error("Error fetching URL:",e),this.videos=[]}finally{this.loading=!1}}}}),E={class:"container"},I={class:"video-selector"},M={key:0,class:"text-center mt-3"},B={key:1,class:"text-info text-center mt-3"},F={key:0},N={key:1},$={key:0,class:"video-grid-container"},j={key:0,class:"video-grid"},L={class:"text-end"},z={key:0,class:"badge bg-primary rounded-pill"},D={class:"video-content"},R={class:"fw-bold text-center mt-2"},q={class:"video-preview"},G=["src"],P={class:"text-center"},Y=["href"],Z={key:1,class:"text-danger text-center mt-3"},H={key:2,class:"text-danger text-center mt-3"},J=m({__name:"VideoView",setup(c){const r=C(),e=p(null);g(e,l=>{l!==null&&r.fetchUrl(l)}),y(()=>{e.value!==null&&r.fetchUrl(e.value)});function u(l){const t=l.match(/(?:v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/);return`https://www.youtube.com/embed/${t?t[1]:""}`}return(l,t)=>(a(),o("div",E,[s("div",I,[t[2]||(t[2]=s("h1",null,"🎬 各年級影片",-1)),t[3]||(t[3]=s("label",{for:"gradeSelect",class:"form-label"},"🎓 選擇年級",-1)),w(s("select",{id:"gradeSelect",class:"form-select","onUpdate:modelValue":t[0]||(t[0]=n=>e.value=n)},t[1]||(t[1]=[s("option",{disabled:"",value:""},"請選擇年級",-1),s("option",{value:"0"},"培訓試教",-1),s("option",{value:"6"},"六年級",-1)]),512),[[x,e.value]])]),e.value===null?(a(),o("div",M," 未選擇年級 ~ ")):i(r).loading?(a(),o("div",B,[t[4]||(t[4]=h(" ...正在載入 ")),e.value==0?(a(),o("span",F,"試教")):(a(),o("span",N,d(e.value),1)),t[5]||(t[5]=h(" 年級的影片資料... "))])):v("",!0),k(V,{name:"fade"},{default:b(()=>[!i(r).loading&&e.value!==null?(a(),o("div",$,[i(r).hasVideos?(a(),o("div",j,[(a(!0),o(S,null,U(i(r).videos,n=>(a(),o("div",{key:n.url,class:"video-card"},[s("div",L,[n.grade!==0?(a(),o("span",z,d(n.grade)+" 年級 ",1)):v("",!0)]),s("div",D,[s("div",R,d(n.title),1),s("div",q,[s("iframe",{src:u(n.url),frameborder:"0",allowfullscreen:""},null,8,G)]),s("div",P,[s("a",{href:n.url,target:"_blank"},"👉 Click to watch on YouTube",8,Y)])])]))),128))])):(a(),o("div",Z," ❗ 查無 "+d(e.value)+" 年級的影片資料。 ",1)),i(r).errorMessage?(a(),o("div",H,d(i(r).errorMessage),1)):v("",!0)])):v("",!0)]),_:1})]))}}),O=A(J,[["__scopeId","data-v-708c1df9"]]);export{O as default};
